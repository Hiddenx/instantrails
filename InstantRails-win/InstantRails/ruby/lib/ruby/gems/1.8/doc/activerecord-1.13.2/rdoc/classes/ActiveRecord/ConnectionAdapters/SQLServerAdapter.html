<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: ActiveRecord::ConnectionAdapters::SQLServerAdapter</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">ActiveRecord::ConnectionAdapters::SQLServerAdapter</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/active_record/connection_adapters/sqlserver_adapter_rb.html">
                lib/active_record/connection_adapters/sqlserver_adapter.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="AbstractAdapter.html">
                AbstractAdapter
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
In ADO mode, this adapter will ONLY work on Windows systems, since it
relies on Win32OLE, which, to my knowledge, is only available on Windows.
</p>
<p>
This mode also relies on the ADO support in the DBI module. If you are
using the one-click installer of Ruby, then you already have DBI installed,
but the ADO module is <b>NOT</b> installed. You will need to get the latest
source distribution of Ruby-DBI from <a
href="http://ruby-dbi.sourceforge.net">ruby-dbi.sourceforge.net</a>/ unzip
it, and copy the file <tt>src/lib/dbd_ado/ADO.rb</tt> to
<tt>X:/Ruby/lib/ruby/site_ruby/1.8/DBD/ADO/ADO.rb</tt> (you will more than
likely need to create the ADO directory). Once you&#8217;ve installed that
file, you are ready to go.
</p>
<p>
In ODBC mode, the adapter requires the ODBC support in the DBI module which
requires the Ruby ODBC module. Ruby ODBC 0.996 was used in development and
testing, and it is available at <a
href="http://www.ch-werner.de/rubyodbc">www.ch-werner.de/rubyodbc</a>/
</p>
<p>
Options:
</p>
<ul>
<li><tt>:mode</tt> &#8212; ADO or ODBC. Defaults to ADO.

</li>
<li><tt>:username</tt> &#8212; Defaults to sa.

</li>
<li><tt>:password</tt> &#8212; Defaults to empty string.

</li>
</ul>
<p>
ADO specific options:
</p>
<ul>
<li><tt>:host</tt> &#8212; Defaults to localhost.

</li>
<li><tt>:database</tt> &#8212; The name of the database. No default, must be
provided.

</li>
</ul>
<p>
ODBC specific options:
</p>
<ul>
<li><tt>:dsn</tt> &#8212; Defaults to nothing.

</li>
</ul>
<p>
ADO code tested on Windows 2000 and higher systems, running ruby 1.8.2
(2004-07-29) [i386-mswin32], and SQL Server 2000 SP3.
</p>
<p>
ODBC code tested on a Fedora Core 4 system, running FreeTDS 0.63, unixODBC
2.2.11, Ruby ODBC 0.996, Ruby DBI 0.0.23 and Ruby 1.8.2. [Linux strongmad
2.6.11-1.1369_FC4 1 Thu Jun 2 22:55:56 EDT 2005 i686 i686 i386 GNU/Linux]
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000515">active?</a>&nbsp;&nbsp;
      <a href="#M000514">adapter_name</a>&nbsp;&nbsp;
      <a href="#M000532">add_limit_offset!</a>&nbsp;&nbsp;
      <a href="#M000524">begin_db_transaction</a>&nbsp;&nbsp;
      <a href="#M000519">columns</a>&nbsp;&nbsp;
      <a href="#M000525">commit_db_transaction</a>&nbsp;&nbsp;
      <a href="#M000535">create_database</a>&nbsp;&nbsp;
      <a href="#M000523">delete</a>&nbsp;&nbsp;
      <a href="#M000534">drop_database</a>&nbsp;&nbsp;
      <a href="#M000521">execute</a>&nbsp;&nbsp;
      <a href="#M000537">indexes</a>&nbsp;&nbsp;
      <a href="#M000520">insert</a>&nbsp;&nbsp;
      <a href="#M000513">native_database_types</a>&nbsp;&nbsp;
      <a href="#M000512">new</a>&nbsp;&nbsp;
      <a href="#M000527">quote</a>&nbsp;&nbsp;
      <a href="#M000531">quote_column_name</a>&nbsp;&nbsp;
      <a href="#M000528">quote_string</a>&nbsp;&nbsp;
      <a href="#M000530">quoted_false</a>&nbsp;&nbsp;
      <a href="#M000529">quoted_true</a>&nbsp;&nbsp;
      <a href="#M000516">reconnect!</a>&nbsp;&nbsp;
      <a href="#M000533">recreate_database</a>&nbsp;&nbsp;
      <a href="#M000541">remove_column</a>&nbsp;&nbsp;
      <a href="#M000539">remove_column</a>&nbsp;&nbsp;
      <a href="#M000542">remove_default_constraint</a>&nbsp;&nbsp;
      <a href="#M000543">remove_index</a>&nbsp;&nbsp;
      <a href="#M000540">rename_column</a>&nbsp;&nbsp;
      <a href="#M000538">rename_table</a>&nbsp;&nbsp;
      <a href="#M000526">rollback_db_transaction</a>&nbsp;&nbsp;
      <a href="#M000517">select_all</a>&nbsp;&nbsp;
      <a href="#M000518">select_one</a>&nbsp;&nbsp;
      <a href="#M000536">tables</a>&nbsp;&nbsp;
      <a href="#M000522">update</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000512" class="method-detail">
        <a name="M000512"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000512.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000512.html');return false;">
          <span class="method-name">new</span><span class="method-args">(connection, logger, connection_options=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000515" class="method-detail">
        <a name="M000515"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000515.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000515.html');return false;">
          <span class="method-name">active?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if the connection is active.
</p>
        </div>
      </div>

      <div id="method-M000514" class="method-detail">
        <a name="M000514"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000514.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000514.html');return false;">
          <span class="method-name">adapter_name</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000532" class="method-detail">
        <a name="M000532"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000532.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000532.html');return false;">
          <span class="method-name">add_limit_offset!</span><span class="method-args">(sql, options)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000524" class="method-detail">
        <a name="M000524"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000524.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000524.html');return false;">
          <span class="method-name">begin_db_transaction</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000519" class="method-detail">
        <a name="M000519"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000519.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000519.html');return false;">
          <span class="method-name">columns</span><span class="method-args">(table_name, name = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000525" class="method-detail">
        <a name="M000525"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000525.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000525.html');return false;">
          <span class="method-name">commit_db_transaction</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000535" class="method-detail">
        <a name="M000535"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000535.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000535.html');return false;">
          <span class="method-name">create_database</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000523" class="method-detail">
        <a name="M000523"></a>

        <div class="method-heading">
          <span class="method-name">delete</span><span class="method-args">(sql, name = nil)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="SQLServerAdapter.html#M000522">update</a>
</p>
        </div>
      </div>

      <div id="method-M000534" class="method-detail">
        <a name="M000534"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000534.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000534.html');return false;">
          <span class="method-name">drop_database</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000521" class="method-detail">
        <a name="M000521"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000521.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000521.html');return false;">
          <span class="method-name">execute</span><span class="method-args">(sql, name = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000537" class="method-detail">
        <a name="M000537"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000537.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000537.html');return false;">
          <span class="method-name">indexes</span><span class="method-args">(table_name, name = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000520" class="method-detail">
        <a name="M000520"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000520.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000520.html');return false;">
          <span class="method-name">insert</span><span class="method-args">(sql, name = nil, pk = nil, id_value = nil, sequence_name = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000513" class="method-detail">
        <a name="M000513"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000513.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000513.html');return false;">
          <span class="method-name">native_database_types</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000527" class="method-detail">
        <a name="M000527"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000527.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000527.html');return false;">
          <span class="method-name">quote</span><span class="method-args">(value, column = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000531" class="method-detail">
        <a name="M000531"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000531.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000531.html');return false;">
          <span class="method-name">quote_column_name</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000528" class="method-detail">
        <a name="M000528"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000528.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000528.html');return false;">
          <span class="method-name">quote_string</span><span class="method-args">(string)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000530" class="method-detail">
        <a name="M000530"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000530.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000530.html');return false;">
          <span class="method-name">quoted_false</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000529" class="method-detail">
        <a name="M000529"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000529.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000529.html');return false;">
          <span class="method-name">quoted_true</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000516" class="method-detail">
        <a name="M000516"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000516.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000516.html');return false;">
          <span class="method-name">reconnect!</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Reconnects to the database, returns false if no connection could be made.
</p>
        </div>
      </div>

      <div id="method-M000533" class="method-detail">
        <a name="M000533"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000533.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000533.html');return false;">
          <span class="method-name">recreate_database</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000541" class="method-detail">
        <a name="M000541"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000541.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000541.html');return false;">
          <span class="method-name">remove_column</span><span class="method-args">(table_name, column_name)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000539" class="method-detail">
        <a name="M000539"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000539.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000539.html');return false;">
          <span class="method-name">remove_column</span><span class="method-args">(table_name, column_name)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000542" class="method-detail">
        <a name="M000542"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000542.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000542.html');return false;">
          <span class="method-name">remove_default_constraint</span><span class="method-args">(table_name, column_name)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000543" class="method-detail">
        <a name="M000543"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000543.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000543.html');return false;">
          <span class="method-name">remove_index</span><span class="method-args">(table_name, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000540" class="method-detail">
        <a name="M000540"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000540.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000540.html');return false;">
          <span class="method-name">rename_column</span><span class="method-args">(table, column, new_column_name)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000538" class="method-detail">
        <a name="M000538"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000538.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000538.html');return false;">
          <span class="method-name">rename_table</span><span class="method-args">(name, new_name)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000526" class="method-detail">
        <a name="M000526"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000526.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000526.html');return false;">
          <span class="method-name">rollback_db_transaction</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000517" class="method-detail">
        <a name="M000517"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000517.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000517.html');return false;">
          <span class="method-name">select_all</span><span class="method-args">(sql, name = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000518" class="method-detail">
        <a name="M000518"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000518.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000518.html');return false;">
          <span class="method-name">select_one</span><span class="method-args">(sql, name = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000536" class="method-detail">
        <a name="M000536"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000536.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000536.html');return false;">
          <span class="method-name">tables</span><span class="method-args">(name = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000522" class="method-detail">
        <a name="M000522"></a>

        <div class="method-heading">
          <a href="SQLServerAdapter.src/M000522.html" target="Code" class="method-signature"
            onclick="popupCode('SQLServerAdapter.src/M000522.html');return false;">
          <span class="method-name">update</span><span class="method-args">(sql, name = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>