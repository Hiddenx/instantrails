
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Module: Camping::Controllers</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
    <script language="JavaScript" type="text/javascript">
    // <![CDATA[

    function toggleSource( id )
    {
    var elem
    var link

    if( document.getElementById )
    {
    elem = document.getElementById( id )
    link = document.getElementById( "l_" + id )
    }
    else if ( document.all )
    {
    elem = eval( "document.all." + id )
    link = eval( "document.all.l_" + id )
    }
    else
    return false;

    if( elem.style.display == "block" )
    {
    elem.style.display = "none"
    link.innerHTML = "show source"
    }
    else
    {
    elem.style.display = "block"
    link.innerHTML = "hide source"
    }
    }

    function openCode( url )
    {
    window.open( url, "SOURCE_CODE", "width=400,height=400,scrollbars=yes" )
    }
    // ]]>
    </script>
</head>
<body>
<div id="menu">
<div id="links">
    <a href="http://redhanded.hobix.com/bits/campingAMicroframework.html">backstory</a> |
    <a href="http://code.whytheluckystiff.net/camping/">wiki</a> |
    <a href="http://code.whytheluckystiff.net/camping/newticket">bugs</a> |
    <a href="http://code.whytheluckystiff.net/svn/camping/">svn</a>
</div>
<h3 class="title">Module: Camping::Controllers</h3>
</div>
<div id="fullpage">
<div id="logo"><img src="../../Camping.gif" /></div>
<div id="pager">
<strong>Files:</strong>
<a href="../../files/lib/camping-unabridged_rb.html" value="File: camping-unabridged.rb">lib/camping-unabridged.rb</a>
<a href="../../files/README.html" value="File: README">README</a>
<a href="../../files/CHANGELOG.html" value="File: CHANGELOG">CHANGELOG</a>
|
<strong>classes:</strong>
<a href="../../classes/Camping.html" title="Module: Camping">Camping</a>
<a href="../../classes/Camping/Views.html" title="Module: Camping::Views">Camping::Views</a>
<a href="../../classes/Camping/Controllers.html" title="Module: Camping::Controllers">Camping::Controllers</a>
<a href="../../classes/Camping/Controllers/Base.html" title="Module: Camping::Controllers::Base">Camping::Controllers::Base</a>
<a href="../../classes/Camping/Controllers/ServerError.html" title="Class: Camping::Controllers::ServerError">Camping::Controllers::ServerError</a>
<a href="../../classes/Camping/Controllers/R.html" title="Class: Camping::Controllers::R">Camping::Controllers::R</a>
<a href="../../classes/Camping/Controllers/NotFound.html" title="Class: Camping::Controllers::NotFound">Camping::Controllers::NotFound</a>
<a href="../../classes/Camping/Helpers.html" title="Module: Camping::Helpers">Camping::Helpers</a>
<a href="../../classes/Camping/Models.html" title="Module: Camping::Models">Camping::Models</a>
<a href="../../classes/Camping/Models/Base.html" title="Module: Camping::Models::Base">Camping::Models::Base</a>
<a href="../../classes/Camping/Mab.html" title="Class: Camping::Mab">Camping::Mab</a>
<a href="../../classes/Camping/H.html" title="Class: Camping::H">Camping::H</a>
</ul>
</div>

    
<div id="Camping::Controllers" class="page_shade">
<div class="page">
<h3>Module Camping::Controllers</h3>

(in files
<a href="../../files/lib/camping-unabridged_rb.html">lib/camping-unabridged.rb</a>
)

<p>
<a href="Controllers.html">Controllers</a> is a module for placing classes
which handle URLs. This is done by defining a route to each class using the
<a href="Controllers/R.html">Controllers::R</a> method.
</p>
<pre>
  module Camping::Controllers
    class Edit &lt; R '/edit/(\d+)'
      def get; end
      def post; end
    end
  end
</pre>
<p>
If no route is set, <a href="../Camping.html">Camping</a> will guess the
route from the class name. The rule is very simple: the route becomes a
slash followed by the lowercased class name. See Controllers::D for the
complete rules of dispatch.
</p>
<h2>Special classes</h2>
<p>
There are two special classes used for handling 404 and 500 errors. The <a
href="Controllers/NotFound.html">NotFound</a> class handles URLs not found.
The <a href="Controllers/ServerError.html">ServerError</a> class handles
exceptions uncaught by your application.
</p>




<h4>Includes</h4>
<ul>
<li><a href="Controllers.html">Controllers</a></li>
<li><a href="Helpers.html">Helpers</a></li>
</ul>

<h2 class="ruled">Methods</h2>
<h4 class="ruled">Public Class method: 
<strong><a name="M000051">D(path)</a></strong></h4>

<p>
Dispatch routes to controller classes. Classes are searched in no
particular order. For each class, routes are checked for a match based on
their order in the routing list given to <a
href="Controllers/R.html">Controllers::R</a>. If no routes were given, the
dispatcher uses a slash followed by the name of the controller lowercased.
</p>

<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000051_source')" id="l_M000051_source">show source</a> ]</p>
  <div id="M000051_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/camping-unabridged.rb, line 432</span>
432:       <span class="ruby-keyword kw">def</span> <span class="ruby-constant">D</span>(<span class="ruby-identifier">path</span>)
433:         <span class="ruby-identifier">constants</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-keyword kw">nil</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">d</span>,<span class="ruby-identifier">c</span><span class="ruby-operator">|</span> 
434:             <span class="ruby-identifier">k</span> = <span class="ruby-identifier">const_get</span>(<span class="ruby-identifier">c</span>)
435:             <span class="ruby-identifier">k</span>.<span class="ruby-identifier">meta_def</span>(<span class="ruby-identifier">:urls</span>){[<span class="ruby-node">&quot;/#{c.downcase}&quot;</span>]}<span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">k</span><span class="ruby-operator">&lt;</span><span class="ruby-constant">R</span>)
436:             <span class="ruby-identifier">d</span><span class="ruby-operator">||</span>([<span class="ruby-identifier">k</span>, <span class="ruby-identifier">$~</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">urls</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/^#{x}\/?$/</span> })
437:         <span class="ruby-keyword kw">end</span><span class="ruby-operator">||</span>[<span class="ruby-constant">NotFound</span>, [<span class="ruby-identifier">path</span>]]
438:       <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
<h4 class="ruled">Public Class method: 
<strong><a name="M000050">R(*urls)</a></strong></h4>

<p>
Add routes to a controller class by piling them into the R method.
</p>
<pre>
  module Camping::Controllers
    class Edit &lt; R '/edit/(\d+)', '/new'
      def get(id)
        if id   # edit
        else    # new
        end
      end
    end
  end
</pre>
<p>
You will need to use routes in either of these cases:
</p>
<ul>
<li>You want to assign multiple routes to a controller.

</li>
<li>You want your controller to receive arguments.

</li>
</ul>
<p>
Most of the time the rules inferred by dispatch method Controllers::D will
get you by just fine.
</p>

<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000050_source')" id="l_M000050_source">show source</a> ]</p>
  <div id="M000050_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File lib/camping-unabridged.rb, line 426</span>
426:       <span class="ruby-keyword kw">def</span> <span class="ruby-constant">R</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">urls</span>); <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">R</span>) { <span class="ruby-identifier">meta_def</span>(<span class="ruby-identifier">:urls</span>) { <span class="ruby-identifier">urls</span> } }; <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>

</div>
</div>


</div>
</body>
</html>