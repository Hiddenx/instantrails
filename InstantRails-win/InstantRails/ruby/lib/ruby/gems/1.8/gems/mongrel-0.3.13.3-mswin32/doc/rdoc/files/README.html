<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: README</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>README</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>README
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Tue May 30 19:37:44 Eastern Standard Time 2006</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h1><a href="../classes/Mongrel.html">Mongrel</a>: Simple Fast Mostly Ruby Web Server</h1>
<p>
<a href="../classes/Mongrel.html">Mongrel</a> is a small library that
provides a very fast HTTP 1.1 server for Ruby web applications. It is not
particular to any framework, and is intended to be just enough to get a web
application running behind a more complete and robust web server.
</p>
<p>
What makes <a href="../classes/Mongrel.html">Mongrel</a> so fast is the
careful use of a C extension to provide fast HTTP 1.1 protocol parsing and
fast URI lookup. This combination makes the server scream without too many
portability issues.
</p>
<h2>Status</h2>
<p>
<a href="../classes/Mongrel.html">Mongrel</a> 0.3.9 now supports a fancy
RubyGems based plugin system called GemPlugin. It uses the basic machinery
of RubyGems to implement dynamically loaded plugins based on dependencies.
Writing a plugin is pretty easy, but right now it&#8217;s not as well
documented as it should be. There is a simple example plugin for adding a
status command to your mongrel. Just do:
</p>
<pre>
 &gt; gem install mongrel_status
</pre>
<p>
And you&#8217;ll then get a new status command. Then just do:
</p>
<pre>
 &gt; cd myrailsapp
 &gt; mongrel_rails start -d
 &gt; mongrel_rails status
</pre>
<p>
And it&#8217;ll print out the PID your Rails app is running under.
</p>
<p>
The GemPlugin project is a sub-project of <a
href="../classes/Mongrel.html">Mongrel</a>, but it&#8217;s licensed under
the Ruby license and is usable outside <a
href="../classes/Mongrel.html">Mongrel</a>
</p>
<h2>Quick Start</h2>
<p>
After you&#8217;ve installed (either with gem install mongrel or via
source) you should have the mongrel_rails command available in your PATH.
Then you just do the following:
</p>
<pre>
 &gt; cd myrailsapp
 &gt; mongrel_rails start
</pre>
<p>
This will start it in the foreground so you can play with it. It runs your
application in production mode. To get help do:
</p>
<pre>
 &gt; mongrel_rails start -h
</pre>
<p>
Finally, you can then start in background mode (probably won&#8217;t work
in win32):
</p>
<pre>
 &gt; mongrel_rails start -d
</pre>
<p>
And you can stop it whenever you like with:
</p>
<pre>
 &gt; mongrel_rails stop
</pre>
<p>
All of which should be done from your application&#8217;s directory. It
writes the PID of the process you ran into log/mongrel.pid.
</p>
<p>
There are also many more new options for configuring the rails runner
including changing to a different directory, adding more MIME types, and
setting processor threads and timeouts.
</p>
<h3>Win32 Service Support</h3>
<p>
<a href="../classes/Mongrel.html">Mongrel</a> now has support for running
as a Win32 service right out of the box. The support is still rough but
works well enough that we decided to release it. You can thank Luis Lavena
for working on this and making it so nice.
</p>
<p>
After you do the gem install, find a Rails application you want to run and
do:
</p>
<pre>
 $ mongrel_rails_service install -n myapp \
     -r c:\my\path\to\myapp -p 4000 -e production
 $ mongrel_rails_service start -n myapp
</pre>
<p>
Now hit the port and poof, works.
</p>
<p>
Stopping a service is simple:
</p>
<pre>
 $ mongrel_rails_service stop -n myapp
</pre>
<p>
If you run into an app that&#8217;s not running right, my suggestion is to
run it with the regular mongrel_rails runner:
</p>
<pre>
 $ cd c:\my\path\to\myapp
 $ mongrel_rails start -p 4500
</pre>
<p>
Since that will spit out error messages and stuff to the console. *Use
CTRL-Pause/Break to stop.*
</p>
<p>
Best thing about the win32 support is that you can simply use the Windows
Services in Control Panel-&gt;Admin Tools to work with it. You can also
install the same Rails app as different installs. For example I&#8217;ve
got myapp_dev, and myapp_prod and just start/stop which one I want to work
with.
</p>
<h2>Install</h2>
<p>
It doesn&#8217;t explicitly require Camping, but if you want to run the
examples/camping/ examples then you&#8217;ll need to install Camping 1.2 at
least (and redcloth I think). These are all available from RubyGems.
</p>
<p>
The library consists of a C extension so you&#8217;ll need a C compiler or
at least a friend who can build it for you.
</p>
<p>
Finally, the source includes a setup.rb for those who hate RubyGems.
</p>
<h2>Usage</h2>
<p>
The examples/simpletest.rb file has the following code as the simplest
example:
</p>
<pre>
 require 'mongrel'

 class SimpleHandler &lt; Mongrel::HttpHandler
    def process(request, response)
      response.start(200) do |head,out|
        head[&quot;Content-Type&quot;] = &quot;text/plain&quot;
        out.write(&quot;hello!\n&quot;)
      end
    end
 end

 h = Mongrel::HttpServer.new(&quot;0.0.0.0&quot;, &quot;3000&quot;)
 h.register(&quot;/test&quot;, SimpleHandler.new)
 h.register(&quot;/files&quot;, Mongrel::DirHandler.new(&quot;.&quot;))
 h.run.join
</pre>
<p>
If you run this and access port 3000 with a browser it will say
&quot;hello!&quot;. If you access it with any url other than
&quot;/test&quot; it will give a simple 404. Check out the <a
href="../classes/Mongrel/Error404Handler.html">Mongrel::Error404Handler</a>
for a basic way to give a more complex 404 message.
</p>
<p>
This also shows the DirHandler with directory listings. This is still rough
but it should work for basic hosting. *File extension to mime type mapping
is missing though.*
</p>
<h2>Speed</h2>
<p>
Like previous releases 0.3.1 continues the trend of making things as fast
as possible. It currently might be a little slower than other releases but
should hold up pretty good against at least WEBrick (especially when
running Rails).
</p>
<p>
As before you can control the number of processor threads (and thus
ActiveRecord database connections) with:
</p>
<pre>
 h = Mongrel::HttpServer.new(&quot;0.0.0.0&quot;, &quot;3000&quot;, 40)
</pre>
<p>
Which will make 40 thread processors. Right now the optimal setting is up
in the air, but 20 seemed to be about the sweet spot on my systems. The
limited processors also means that you can use ActiveRecord as-is and it
will create a matching database connection for each processor thread. More
on this in future releases.
</p>
<h2>Contact</h2>
<p>
E-mail zedshaw at zedshaw.com and I&#8217;ll help. Comments about the API
are welcome.
</p>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>