<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Sending Data to the Clipboard</title><meta name="generator" content="DocBook XSL Stylesheets V1.61.2"><link rel="home" href="book.html" title="Developing Graphical User Interfaces with FXRuby"><link rel="up" href="clipboardtut.html" title="Chapter&nbsp;4.&nbsp;Working With the Clipboard"><link rel="previous" href="ch04s02.html" title="Acquiring the Clipboard"><link rel="next" href="ch04s04.html" title="Pasting Data from the Clipboard"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Sending Data to the Clipboard</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch04s02.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;4.&nbsp;Working With the Clipboard</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch04s04.html">Next</a></td></tr></table><hr></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1076"></a>Sending Data to the Clipboard</h2></div></div><div></div></div><p>Whenever some other window requests the clipboard's contents (e.g.
    as a result of a "paste" operation) FOX will send a
    <tt class="constant">SEL_CLIPBOARD_REQUEST</tt> message to the current
    clipboard owner. Remember, the clipboard owner is the window that called
    <tt class="methodname">acquireClipboard()</tt>. For our example, the main
    window is acting as the clipboard owner and so it needs to handle the
    <tt class="constant">SEL_CLIPBOARD_REQUEST</tt> message:</p><table border="0" bgcolor="#E0E0E0" width="100%"><tr><td><pre class="programlisting"># Handle clipboard request
self.connect(SEL_CLIPBOARD_REQUEST) do
  setDNDData(FROM_CLIPBOARD, FXWindow.stringType, Fox.fxencodeStringData(@clippedCustomer.to_s))
end
</pre></td></tr></table><p>The <tt class="methodname">setDNDData()</tt> method takes three
    arguments. The first argument tells FOX which kind of data transfer we're
    trying to accomplish; as it turns out, this method can be used for
    drag-and-drop (<tt class="constant">FROM_DRAGNDROP</tt>) and X11 selection
    (<tt class="constant">FROM_SELECTION</tt>) data transfer as well. The second
    argument to <tt class="methodname">setDNDData()</tt> is the drag type for the
    data and the last argument is the data itself, a binary string.</p><p>If you're wondering why we need to call the
    <tt class="methodname">fxencodeStringData()</tt> module method to preprocess
    the string returned by the call to <tt class="methodname">Customer#to_s</tt>,
    that's a reasonable thing to wonder about. In order for FOX to play nice
    with other clipboard-aware applications, it must be able to store string
    data on the clipboard in the format expected by those applications.
    Unfortunately, that expected format is platform-dependent and does not
    always correspond directly to the format that Ruby uses internally to
    store its string data. The <tt class="methodname">fxencodeStringData()</tt>
    method (and the corresponding
    <tt class="methodname">fxdecodeStringData()</tt> method) provide you with a
    platform-independent way of sending (or receiving) string data with the
    <tt class="constant">stringType</tt> drag type.</p><p>If you run the program as it currently stands, you should now be
    able to select a customer from the list, click the "Copy" button and then
    paste the selected customer data (as a string) into some other
    application. For example, if you're trying this tutorial on a Windows
    machine, try pasting into a copy of Notepad or Microsoft Word. The pasted
    text should look something like:</p><table border="0" bgcolor="#E0E0E0" width="100%"><tr><td><pre class="programlisting">#&lt;struct Struct::Customer name="Joe Smith", address="123 Maple, Anytown, NC", zip=12345&gt;
</pre></td></tr></table></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch04s02.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="clipboardtut.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch04s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Acquiring the Clipboard&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="book.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Pasting Data from the Clipboard</td></tr></table></div></body></html>